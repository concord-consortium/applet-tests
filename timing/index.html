---
layout: default
title: Test Applet Load Timing
show_in_toc: true
---
<h4>If an applet is referenced too soon, then sometimes calling methods on the applet fail.</h4>

<a href="test.html">Run Timing Test</a>

<p>This test points out a failure in OS X 10.7 or 10.8, Firefox 21 or 22, Java 1.7.0_25-b15
The test injects an applet on the page, saves a reference to the applet dom object, then calls a method on the applet.
If the reference to the dom object is saved too soon then sometimes the method call fails.</p>

<p>To run this test, reload the test page multiple times. You should see 'fail' in the method call column. If you you increase
the initialDelay and reload the page the failures should decrease.
If the initialDelay is 0 then setTimeout is not used. A setTimeout(...,0) reduces the number of failures compaired to no
setTimeout. My testing has shown that a 50ms initialDelay works without failures.</p>

<p>This issues does not appear present in Safari with the same OS and Java. It also doesn't appear with the same
version of Firefox but on OS X 10.6 with Java 1.6. It also doesn't appear in Windows 7 with the same Firefox and Java
versions. When the method call suceeds applet.toString() is the Java class name, when the method call fails it is
[object HTMLAppletElement].
This issue can also be seen without injecting the applet on the page. However the page needs to be
stripped down. If there is content before the applet tag then the issue rarely occurs. If there is no content before
the applet tag, then the test will fail often, and it can take up to a 200ms initialDelay before the failures completely
go away.</p>
</p>

<div>
<div id='gist-it-timingjs' style='width: 34em; float: left; margin-left: 10px'>
<script src="http://gist-it.appspot.com/github/{{ site.github_repo }}/blob/gh-pages/timing/timing.js"></script>
</div>
<div id='gist-it-appletjs' style='width: 24em; float: left; margin-left: 10px'>
<script src="http://gist-it.appspot.com/github/{{ site.github_repo }}/blob/gh-pages/timing/applets/DetectionApplet.java?slice=5:"></script>
</div>
</div>